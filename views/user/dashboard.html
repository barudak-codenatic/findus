<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FindUs - Solusi Kebutuhan Mahasiswa</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,200,0,0" />
</head>

<body class="font-sans">
  <header class="header">
    <div class="flex justify-center items-center w-full bg-[#272343] text-white p-2">
      <nav class="flex space-x-4 items-center text-xs font-light">
        <a href="" class="flex items-center gap-1">
          <span class="material-symbols-outlined !text-lg">
            keyboard_arrow_down
          </span>
          Eng
        </a>
        <a href="">Faqs</a>
        <a href="" class="flex items-center gap-1">
          <span class="material-symbols-outlined !text-lg">
            error
          </span>
          Need Help
        </a>
      </nav>
    </div>
    <div class="bg-gray-100">
      <div class="container mx-auto flex justify-between items-center w-full px-28 py-4">
        <a class="brand" href=""><img src="/public/images/Logo.svg" alt=""></a>
        <input type="text" placeholder="Search here..."
          class="w-full md:w-1/3 px-4 py-2 text-sm bg-white rounded focus:outline-none" />
        <nav class="flex space-x-4 items-center text-xs">
          <a class="bg-white rounded px-4 py-1 flex items-center gap-1" href="">
            <span class="material-symbols-outlined !text-lg">
              history
            </span>
            Riwayat
          </a>
          <a class="bg-white rounded px-4 py-1 flex items-center gap-1" href="/user/chat">
            <span class="material-symbols-outlined !text-lg">
              chat
            </span>
            Chat
          </a>
          <a class="bg-white rounded px-4 py-1 flex items-center gap-1" href="">
            <span class="material-symbols-outlined !text-lg">
              shopping_cart
            </span>
            Cart
          </a>
          <a class="bg-white rounded px-4 py-1" href="">
            <span class="material-symbols-outlined !text-lg">
              favorite
            </span>
          </a>
          <a class="bg-white rounded px-4 py-1 flex items-center gap-1" href="" id="profile-link">
            <span class="material-symbols-outlined !text-lg">
              person
            </span>
          </a>
        </nav>
      </div>
    </div>
    <div class="border-b-1 border-gray-300">
      <div class="container mx-auto flex justify-between items-center w-full px-28 py-4 text-xs">
        <nav class="flex space-x-6 items-center">
          <button class="bg-white border border-gray-300 px-4 py-1 rounded text-sm flex items-center gap-1">
            <span class="material-symbols-outlined !text-lg">
              menu
            </span>
            Semua Kategori
          </button>
          <a href="" class="text-gray-700">Home</a>
          <a href="" class="text-gray-700">Product</a>
          <a href="" class="text-gray-700">Service</a>
          <a href="" class="text-gray-700">Expense</a>
          <a href="" class="text-gray-700">About</a>
        </nav>
        <div class="contact flex gap-2"><span class="text-gray-500">Contact:</span>(0812) 1284-8626</div>
      </div>
    </div>
  </header>
  <main class="container mx-auto px-6 py-2 mb-24">
    <section class="hero my-6 rounded-md w-full"><img src="/public/images/Hero.svg" alt="">
    </section>
    <section class="products">
      <h2 class="text-2xl font-bold mb-12">Related Products</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-14">
        <div class="product bg-white rounded">
          <img src="/public/images/jasa1.jpg" alt="Product 1" class="w-full h-46 rounded object-cover mb-2">
          <h3 class="text-lg font-semibold">Jasa Sedot WC</h3>
          <p class="text-gray-500 font-medium">Terima Jasa Sedot WC. Mudah & Cepat.</p>
          <p class="font-medium">Rp.300.000-800.000</p>
        </div>
      </div>
    </section>
  </main>
  <footer class="border-t border-gray-200 py-10 text-sm text-gray-700">
    <div class="container mx-auto flex justify-start w-full px-28 py-4 gap-24">
      <div class="w-1/4 flex flex-col gap-4">
        <a class="brand" href=""><img src="/public/images/Logo.svg" alt=""></a>
        <p>Platform online untuk mahasiswa yang kos! Belanja kebutuhan harian, perlengkapan kamar, serta pesan
          layanan seperti jasa layanan, bersih-bersih, dan lainnya dengan mudah.</p>
        <div class="flex gap-3">
          <a href="#"><img src="icon-fb.svg" alt="FB" class="w-5"></a>
          <a href="#"><img src="icon-ig.svg" alt="IG" class="w-5"></a>
          <a href="#"><img src="icon-tw.svg" alt="TW" class="w-5"></a>
        </div>
      </div>

      <div>
        <h5 class="font-medium mb-2 text-gray-400">Category</h5>
        <ul class="space-y-1">
          <li><a href="#" class="hover:underline hover:text-[#029FAE]">Peralatan Mandi</a></li>
          <li><a href="#" class="hover:underline hover:text-[#029FAE]">Alat Masak</a></li>
          <li><a href="#" class="hover:underline hover:text-[#029FAE]">Elektronik</a></li>
          <li><a href="#" class="hover:underline hover:text-[#029FAE]">Dekorasi Kamar</a></li>
          <li><a href="#" class="hover:underline hover:text-[#029FAE]">Alat Makan</a></li>
          <li><a href="#" class="hover:underline hover:text-[#029FAE]">Jasa Layanan</a></li>
        </ul>
      </div>

      <div>
        <h5 class="font-medium mb-2 text-gray-400">Support</h5>
        <ul class="space-y-1">
          <li><a href="#" class="hover:underline">Cara Pemesanan</a></li>
          <li><a href="#" class="hover:underline">Syarat & Ketentuan</a></li>
          <li><a href="#" class="hover:underline">Kebijakan Privasi</a></li>
          <li><a href="#" class="hover:underline">Hubungi Kami</a></li>
        </ul>
      </div>
    </div>

    <div class="mt-8 border-t border-gray-200 pt-4 text-center text-xs text-gray-500">
      &copy; 2025 - FindUS â€¢ Designed & Developed by epaarito
    </div>
  </footer>
  <script>
    fetch("/api/me")
      .then((res) => res.json())
      .then((data) => {
        if (!data.user || data.user.role !== "USER") {
          alert("Akses ditolak. Silakan login sebagai USER.");
          window.location.href = "/login";
        } else {
          const profileLink = document.getElementById("profile-link");
          if (profileLink) {
            profileLink.innerHTML = `
              <div class="relative cursor-pointer select-none" id="profile-dropdown-parent">
                <span class="flex items-center gap-1" id="profile-dropdown-toggle">
                  <span class="material-symbols-outlined !text-lg">person</span>
                  ${data.user.name}
                  <span class="material-symbols-outlined !text-lg">expand_more</span>
                </span>
                <div id="profile-dropdown-menu" class="hidden absolute right-0 mt-2 w-40 bg-white rounded shadow-lg z-50 shadow-md text-gray-700">
                  <a href="/profile" class="block px-4 py-2 hover:bg-gray-100">Profile</a>
                  <a href="/logout" class="block px-4 py-2 hover:bg-gray-100">Logout</a>
                </div>
              </div>
            `;
            profileLink.href = "javascript:void(0)";

            const toggle = document.getElementById("profile-dropdown-toggle");
            const menu = document.getElementById("profile-dropdown-menu");
            document.addEventListener("click", function (e) {
              if (toggle && menu) {
                if (toggle.contains(e.target)) {
                  menu.classList.toggle("hidden");
                } else if (!menu.contains(e.target)) {
                  menu.classList.add("hidden");
                }
              }
            });
          }
        }
      })
      .catch((err) => {
        console.error("Gagal memuat data user:", err);
        window.location.href = "/login";
      });

    fetch("/api/services")
      .then(res => res.json())
      .then(data => {
        const services = data.services || [];
        const productsGrid = document.querySelector('.products .grid');
        if (!productsGrid) return;

        productsGrid.innerHTML = "";

        services.forEach(service => {
          const card = document.createElement('div');
          card.className = "product bg-white rounded";
          card.innerHTML = `
          <a href="/services/${service.id}/detail" style="display:block; text-decoration:none; color:inherit;">
          <img src="${service.image_url || '/public/images/jasa1.jpg'}" alt="${service.name}" class="w-full h-46 rounded object-cover mb-2">
          <h3 class="text-lg font-semibold">${service.name}</h3>
          <p class="text-gray-500 font-medium">${service.description || ''}</p>
          <p class="font-medium">Rp.${service.price ? service.price.toLocaleString('id-ID') : '-'}</p>
        </a>
        `;
          productsGrid.appendChild(card);
        });
      })
      .catch(err => {
        console.error("Gagal memuat layanan:", err);
      });
  </script>

</body>

</html>